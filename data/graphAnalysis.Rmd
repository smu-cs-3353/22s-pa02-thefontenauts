---
title: "Program 2 Graph Analysis"
author: "Ryan Schaefer and Wes Anderson"
output: pdf_document
---

## Create Dataset
```{r}
library(ggplot2)
library(ggpubr)
data = read.csv("sorting.csv")
data$n2 = data$size ^ 2
data$nlogn = log(data$size) * data$size
data
```

## Insertion Sort
```{r}
insertionTimes = aggregate(insertion_time ~ var_type + size + n2, data = data, FUN = mean)
ggplot(insertionTimes, aes(x = size, y = insertion_time, color = var_type)) + 
  geom_line() + 
  labs(title = "Insertion Sort Time By Data Set Size and Data Type", x = "n", y = "Insertion Sort Time") + 
  guides(color = guide_legend(title = "Data Type"))
```

#### Regression Model - Integers
```{r}
insertionInts = subset(insertionTimes, var_type == "int")
insertionModel = lm(insertion_time ~ n2, data = insertionInts)
summary(insertionModel)
```

```{r}
ggplot(data=insertionInts, aes(x=n2, y=insertion_time)) +
  labs(title = "Insertion Sort With Integer Data Regression Model", x = "n^2", y = "Insertion Sort Time") +
  geom_smooth(method="lm") +
  geom_point() +
  stat_regline_equation(label.x=0, label.y=2500) +
  stat_cor(aes(label=..rr.label..), label.x=0, label.y=2300)
```

#### Regression Model - Strings
```{r}
insertionStrings = subset(insertionTimes, var_type == "string")
insertionModel = lm(insertion_time ~ n2, data = insertionStrings)
summary(insertionModel)
```

```{r}
ggplot(data=insertionStrings, aes(x=n2, y=insertion_time)) +
  labs(title = "Insertion Sort With String Data Regression Model", x = "n^2", y = "Insertion Sort Time") +
  geom_smooth(method="lm") +
  geom_point() +
  stat_regline_equation(label.x=0, label.y=7500) +
  stat_cor(aes(label=..rr.label..), label.x=0, label.y=7000)
```

## Quick Sort
```{r}
quickTimes = aggregate(quick_time ~ var_type + size + nlogn, data = data, FUN = mean)
ggplot(quickTimes, aes(x = size, y = quick_time, color = var_type)) + 
  geom_line() + 
  labs(title = "Quick Sort Time By Data Set Size and Data Type", x = "n", y = "Quick Sort Time") + 
  guides(color = guide_legend(title = "Data Type"))
```

#### Regression Model - Integers
```{r}
quickInts = subset(quickTimes, var_type == "int")
quickModel = lm(quick_time ~ nlogn, data = quickInts)
summary(quickModel)
```

```{r}
ggplot(data=quickInts, aes(x=nlogn, y=quick_time)) +
  labs(title = "Quick Sort With Integer Data Regression Model", x = "nlogn", y = "Quick Sort Time") +
  geom_smooth(method="lm") +
  geom_point() +
  stat_regline_equation(label.x=0, label.y=0.4) +
  stat_cor(aes(label=..rr.label..), label.x=0, label.y=0.37)
```

#### Regression Model - Strings
```{r}
quickStrings = subset(quickTimes, var_type == "string")
quickModel = lm(quick_time ~ nlogn, data = quickStrings)
summary(quickModel)
```

```{r}
ggplot(data=quickStrings, aes(x=nlogn, y=quick_time)) +
  labs(title = "Quick Sort With String Data Regression Model", x = "nlogn", y = "Quick Sort Time") +
  geom_smooth(method="lm") +
  geom_point() +
  stat_regline_equation(label.x=0, label.y=1.5) +
  stat_cor(aes(label=..rr.label..), label.x=0, label.y=1.4)
```

## Merge Sort
```{r}
mergeTimes = aggregate(merge_time ~ var_type + size + nlogn, data = data, FUN = mean)
ggplot(mergeTimes, aes(x = size, y = merge_time, color = var_type)) + 
  geom_line() + 
  labs(title = "Merge Sort Time By Data Set Size and Data Type", x = "n", y = "Merge Sort Time") + 
  guides(color = guide_legend(title = "Data Type"))
```

#### Regression Model - Integers
```{r}
mergeInts = subset(mergeTimes, var_type == "int")
mergeModel = lm(merge_time ~ nlogn, data = mergeInts)
summary(mergeModel)
```

```{r}
ggplot(data=mergeInts, aes(x=nlogn, y=merge_time)) +
  labs(title = "Merge Sort With Integer Data Regression Model", x = "nlogn", y = "Merge Sort Time") +
  geom_smooth(method="lm") +
  geom_point() +
  stat_regline_equation(label.x=0, label.y=6) +
  stat_cor(aes(label=..rr.label..), label.x=0, label.y=5.5)
```

#### Regression Model - Strings
```{r}
mergeStrings = subset(mergeTimes, var_type == "string")
mergeModel = lm(merge_time ~ nlogn, data = mergeStrings)
summary(mergeModel)
```

```{r}
ggplot(data=mergeStrings, aes(x=nlogn, y=merge_time)) +
  labs(title = "Merge Sort With String Data Regression Model", x = "nlogn", y = "Merge Sort Time") +
  geom_smooth(method="lm") +
  geom_point() +
  stat_regline_equation(label.x=0, label.y=6) +
  stat_cor(aes(label=..rr.label..), label.x=0, label.y=5.5)
```

## Shell Sort
```{r}
shellTimes = aggregate(shell_time ~ var_type + size + nlogn, data = data, FUN = mean)
ggplot(shellTimes, aes(x = size, y = shell_time, color = var_type)) + 
  geom_line() + 
  labs(title = "Shell Sort Time By Data Set Size and Data Type", x = "n", y = "Shell Sort Time") + 
  guides(color = guide_legend(title = "Data Type"))
```

#### Regression Model - Integers
```{r}
shellInts = subset(shellTimes, var_type == "int")
shellModel = lm(shell_time ~ nlogn, data = shellInts)
summary(shellModel)
```

```{r}
ggplot(data=shellInts, aes(x=nlogn, y=shell_time)) +
  labs(title = "Shell Sort With Integer Data Regression Model", x = "nlogn", y = "Shell Sort Time") +
  geom_smooth(method="lm") +
  geom_point() +
  stat_regline_equation(label.x=0, label.y=0.7) +
  stat_cor(aes(label=..rr.label..), label.x=0, label.y=0.65)
```

#### Regression Model - Strings
```{r}
shellStrings = subset(shellTimes, var_type == "string")
shellModel = lm(shell_time ~ nlogn, data = shellStrings)
summary(shellModel)
```

```{r}
ggplot(data=shellStrings, aes(x=nlogn, y=shell_time)) +
  labs(title = "Shell Sort With String Data Regression Model", x = "nlogn", y = "Shell Sort Time") +
  geom_smooth(method="lm") +
  geom_point() +
  stat_regline_equation(label.x=0, label.y=4) +
  stat_cor(aes(label=..rr.label..), label.x=0, label.y=3.7)
```

## Intro Sort
```{r}
introTimes = aggregate(intro_time ~ var_type + size + nlogn, data = data, FUN = mean)
ggplot(introTimes, aes(x = size, y = intro_time, color = var_type)) + 
  geom_line() + 
  labs(title = "Intro Sort Time By Data Set Size and Data Type", x = "Data Set Size", y = "Intro Sort Time") + 
  guides(color = guide_legend(title = "Data Type"))
```

#### Regression Model - Integers
```{r}
introInts = subset(introTimes, var_type == "int")
introModel = lm(intro_time ~ nlogn, data = introInts)
summary(introModel)
```

```{r}
ggplot(data=introInts, aes(x=nlogn, y=intro_time)) +
  labs(title = "Intro Sort With Integer Data Regression Model", x = "nlogn", y = "Intro Sort Time") +
  geom_smooth(method="lm") +
  geom_point() +
  stat_regline_equation(label.x=0, label.y=2.25) +
  stat_cor(aes(label=..rr.label..), label.x=0, label.y=2.1)
```

#### Regression Model - Strings
```{r}
introStrings = subset(introTimes, var_type == "string")
introModel = lm(intro_time ~ nlogn, data = introStrings)
summary(introModel)
```

```{r}
ggplot(data=introStrings, aes(x=nlogn, y=intro_time)) +
  labs(title = "Intro Sort With String Data Regression Model", x = "nlogn", y = "Intro Sort Time") +
  geom_smooth(method="lm") +
  geom_point() +
  stat_regline_equation(label.x=0, label.y=4) +
  stat_cor(aes(label=..rr.label..), label.x=0, label.y=3.7)
```

## Tim Sort
```{r}
timTimes = aggregate(tim_time ~ var_type + size + nlogn, data = data, FUN = mean)
ggplot(timTimes, aes(x = size, y = tim_time, color = var_type)) + 
  geom_line() + 
  labs(title = "Tim Sort Time By Data Set Size and Data Type", x = "Data Set Size", y = "Tim Sort Time") + 
  guides(color = guide_legend(title = "Data Type"))
```

#### Regression Model - Integers
```{r}
timInts = subset(timTimes, var_type == "int")
timModel = lm(tim_time ~ nlogn, data = timInts)
summary(timModel)
```

```{r}
ggplot(data=timInts, aes(x=nlogn, y=tim_time)) +
  labs(title = "Tim Sort With Integer Data Regression Model", x = "nlogn", y = "Tim Sort Time") +
  geom_smooth(method="lm") +
  geom_point() +
  stat_regline_equation(label.x=0, label.y=2.25) +
  stat_cor(aes(label=..rr.label..), label.x=0, label.y=2.1)
```

#### Regression Model - Strings
```{r}
timStrings = subset(timTimes, var_type == "string")
timModel = lm(tim_time ~ nlogn, data = timStrings)
summary(timModel)
```

```{r}
ggplot(data=timStrings, aes(x=nlogn, y=tim_time)) +
  labs(title = "Tim Sort With String Data Regression Model", x = "nlogn", y = "Tim Sort Time") +
  geom_smooth(method="lm") +
  geom_point() +
  stat_regline_equation(label.x=0, label.y=4) +
  stat_cor(aes(label=..rr.label..), label.x=0, label.y=3.7)
```